# Ploidy Assay Analysis Output

This directory contains the output files and figures generated by the ploidy discrepancy analysis script.

## Output Files

### ploidy_method_comparison.csv

The main output file containing the complete comparison of benomyl assay and flow cytometry results for all wells. Key columns include:

- `well_id`: The standardized well identifier (e.g., "WGS1A1")
- `benomyl_says_diploid`: Whether the benomyl assay indicates diploid (TRUE/FALSE)
- `flow_says_diploid`: Whether flow cytometry indicates diploid (TRUE/FALSE)
- `agreement`: Whether the two methods agree (TRUE/FALSE)
- `benomyl_is_borderline`: Whether the benomyl result is borderline (TRUE/FALSE)
- `flow_mixed_population`: Whether flow cytometry indicates a mixed population (TRUE/FALSE)
- `flow_haploid_percent`: Percentage of cells in the haploid gate
- `flow_diploid_percent`: Percentage of cells in the diploid gate
- `flow_ambiguous_percent`: Percentage of cells in the ambiguous gate (could be either G2 haploid or G1 diploid)
- `disagreement_type`: Type of disagreement (if applicable)
- `disagreement_explanation`: Potential explanation for disagreement (if applicable)

### ploidy_method_discrepancy_summary.txt

A comprehensive text report summarizing the analysis results, including:

- Overview statistics on method agreement
- Breakdown of disagreement types and potential explanations
- Analysis of ambiguous gate statistics
- Results by plate
- Automated conclusions about patterns and sources of disagreement

### discrepancy_borderline_benomyl.csv

Subset of wells where methods disagree and the benomyl result is borderline.

### discrepancy_mixed_flow.csv

Subset of wells where methods disagree and flow cytometry indicates a mixed population.

### discrepancy_clean.csv

Subset of wells where methods disagree despite both methods showing high confidence. These are the most interesting cases for biological investigation.

## Figures Directory

The `figures/` subdirectory contains visualizations to help understand patterns of agreement and disagreement:

### agreement_by_plate.png

Bar chart showing the number of agreements and disagreements by plate.

### ambiguous_by_agreement.png

Box plot comparing the distribution of ambiguous gate percentages between cases where methods agree versus disagree.

### disagreement_types.png

Pie chart showing the breakdown of disagreement types (benomyl says diploid when flow says haploid, and vice versa).

### disagreement_explanations.png

Pie chart showing the breakdown of potential explanations for disagreements.

### haploid_vs_diploid_by_agreement.png

Scatter plot of haploid versus diploid percentages in flow cytometry, colored by method agreement.

## Using These Files

- For a comprehensive view of all results, use `ploidy_method_comparison.csv`
- For a high-level summary, refer to `ploidy_method_discrepancy_summary.txt`
- To focus on specific types of disagreements, examine the specialized discrepancy CSV files
- For visual patterns, review the figures in the `figures/` directory

## Interpreting Cell Distribution

In the flow cytometry data:
- **Haploid gate**: Cells with clear haploid DNA content
- **Diploid gate**: Cells with clear diploid DNA content
- **Ambiguous gate**: Cells that could be haploid G2 or diploid G1
